<%#
  Página para gestionar los Tipos de Ausencia.
  Muestra una tabla con la configuración de cada tipo y permite
  crear, editar y eliminar.
%>

<% content_for :title, "Tipos de Ausencia" %>

<div class="d-flex justify-content-between align-items-center mb-4">
  <h1>Gestión de Tipos de Ausencia</h1>
  <div>
    <%= link_to 'Nuevo Tipo de Ausencia', new_admin_tipo_ausencia_path, class: 'btn btn-primary' %>
    <%= link_to 'Volver al Panel', admin_root_path, class: 'btn btn-secondary' %>
  </div>
</div>

<p class="lead">
  Aquí se configuran los diferentes tipos de ausencia y las reglas de negocio que se les aplican.
</p>

<div class="card">
  <div class="table-responsive">
    <table class="table table-striped table-hover mb-0 align-middle">
      <thead>
        <tr>
          <th scope="col">Nombre</th>
          <th scope="col">Abreviatura</th>
          <th scope="col">Modalidad</th>
          <th scope="col">Retribuida</th>
          <th scope="col">Bolsa Afectada</th>
          <th scope="col">Límite Anual</th>
          <th scope="col">Genera Deuda</th>
          <th scope="col" class="text-end">Acciones</th>
        </tr>
      </thead>
      <tbody>
        <% @tipo_ausencias.each do |tipo_ausencia| %>
          <tr>
            <td class="fw-bold"><%= tipo_ausencia.nombre %></td>
            <td><span class="badge bg-light text-dark"><%= tipo_ausencia.abreviatura %></span></td>
            <td>
              <% if tipo_ausencia.es_fraccionable? %>
                <span class="badge bg-info-subtle text-info-emphasis">Por Horas</span>
              <% else %>
                <span class="badge bg-secondary-subtle text-secondary-emphasis">Día Completo</span>
              <% end %>
            </td>
            <td><%= tipo_ausencia.es_retribuida? ? 'Sí' : 'No' %></td>
            <td>
              <%= tipo_ausencia.categoria_bolsa_afectada.to_s.gsub('_', ' ').gsub('bolsa ', '').capitalize %>
            </td>
            <td>
              <%= tipo_ausencia.limite_horas_anuales.present? ? "#{tipo_ausencia.limite_horas_anuales.to_f}h" : 'No' %>
            </td>
            <td><%= tipo_ausencia.genera_deuda_en_bolsa? ? 'Sí' : 'No' %></td>
            <td class="text-end">
              <div class="d-flex justify-content-end gap-2">
                <%= link_to 'Editar', edit_admin_tipo_ausencia_path(tipo_ausencia), class: 'btn btn-sm btn-outline-secondary' %>
                <%= button_to 'Eliminar', admin_tipo_ausencia_path(tipo_ausencia),
                    method: :delete,
                    class: 'btn btn-sm btn-outline-danger',
                    form: { data: { turbo_confirm: "ATENCIÓN: ¿Estás seguro de que quieres eliminar '#{tipo_ausencia.nombre}'? Esta acción no se puede deshacer." } } %>
              </div>
            </td>
          </tr>
        <% end %>
      </tbody>
    </table>
  </div>
</div>