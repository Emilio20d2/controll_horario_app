<%#
  Vista para listar todos los trabajadores.
  Utiliza el layout 'admin' y las clases CSS unificadas.
%>

<div class="page-header">
  <h1>Listado de Empleados</h1>
  <div>
    <%= link_to 'Nuevo Empleado', new_admin_trabajador_path, class: 'btn btn-primary' %>
    <%= link_to 'Volver al MenÃº', root_path, class: 'btn btn-secondary ms-2' %>
  </div>
</div>

<div class="card">
  <div class="card-body p-0"> <%# p-0 para que la tabla ocupe todo el espacio de la tarjeta %>
    <div class="table-responsive">
      <table class="table table-striped table-hover mb-0">
        <thead class="thead-light">
          <tr>
            <th class="py-3 px-4">Nombre</th>
            <th class="py-3 px-4">Tipo de Contrato</th>
            <th class="py-3 px-4">Jornada Semanal</th>
            <th class="py-3 px-4">Saldo Horas</th>
            <th class="text-end py-3 px-4">Acciones</th>
          </tr>
        </thead>
        <tbody>
          <% @trabajadores.each do |trabajador| %>
            <tr>
              <td class="py-3 px-4 align-middle"><%= trabajador.nombre %></td>
              <td class="py-3 px-4 align-middle"><%= trabajador.tipo_contrato&.nombre || 'N/A' %></td>
              <td class="py-3 px-4 align-middle"><%= number_to_human(trabajador.jornada_semanal_actual, precision: 2, strip_insignificant_zeros: true) %> h</td>
              <td class="py-3 px-4 align-middle">
                <% saldo = trabajador.bolsa_horas_saldo %>
                <%= number_with_precision(
                  (saldo&.saldo_bolsa_horas || 0) + (saldo&.saldo_bolsa_festivos || 0) + (saldo&.saldo_bolsa_libranza || 0),
                  precision: 2
                ) %>
              </td>
              <td class="text-end py-3 px-4 align-middle">
                <%= link_to 'Ver Ficha', admin_trabajador_path(trabajador), class: 'btn btn-sm btn-primary' %>
              </td>
            </tr>
          <% end %>
        </tbody>
      </table>
    </div>
  </div>
</div>