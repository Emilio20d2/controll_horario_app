<%# app/views/fichajes/semanal.html.erb %>
<% content_for :title, "Confirmación Semanal" %>

<div class="content-box container mt-3"
     data-controller="semanal"
     data-semanal-year-value="<%= @anio_seleccionado %>"
     data-semanal-week-num-value="<%= @semana_seleccionada %>">
  <div class="week-header d-flex justify-content-between align-items-center">
    <div class="d-flex align-items-center">
      <%= link_to "◀", fichajes_semanal_path(@params_semana_anterior), class: "btn btn-secondary btn-sm" %>
      <span class="mx-2 fw-bold">
        Semana del <%= l(@fecha_lunes, format: :short) %> al <%= l(@fecha_lunes + 6.days, format: :short) %>
      </span>
      <%= link_to "▶", fichajes_semanal_path(@params_semana_siguiente), class: "btn btn-secondary btn-sm" %>
      <%= form_with url: fichajes_semanal_path, method: :get, class: "d-inline-flex ms-3" do |f| %>
        <%= f.date_field :fecha, value: @fecha_lunes, class: "form-control form-control-sm" %>
        <%= f.submit "Ir", class: "btn btn-primary btn-sm ms-1" %>
      <% end %>
    </div>
    <%= link_to "Volver al menú", root_path, class: "btn btn-outline-secondary btn-sm" %>
  </div>

  <table class="schedule-table mt-3">
    <thead>
      <tr>
        <th>Empleado</th>
        <% @fechas_semana.each do |fecha| %>
          <th class="text-center">
            <%= l(fecha, format: '%A') %><br>
            <small><%= l(fecha, format: '%d/%m') %></small>
          </th>
        <% end %>
        <th>Resumen</th>
        <th class="acciones-col">Acciones</th>
      </tr>
    </thead>
    <tbody>
      <%= render partial: 'fila_trabajador', collection: @trabajadores, as: :trabajador %>
    </tbody>
  </table>
</div>
